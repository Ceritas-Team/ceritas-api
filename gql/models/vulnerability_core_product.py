from sqlalchemy import Column, BigInteger, Text, Boolean, TIMESTAMP, ForeignKey
from . import Base
from sqlalchemy.orm import relationship
from .core_product import CoreProduct
from .vulnerability import Vulnerability

class VulnerabilityCoreProduct(Base):
    __tablename__ = 'vulnerability_core_product'

    id = Column(BigInteger, primary_key=True, nullable=False)
    vulnerability_id = Column(BigInteger, ForeignKey('vulnerabilities.id'), nullable=False)
    core_product_id = Column(BigInteger, ForeignKey('core_products.id'), nullable=False)
    user_id = Column(BigInteger, ForeignKey('users.id'))
    note = Column(Text)
    is_visible = Column(Boolean, nullable=False, default=False)
    date_added = Column(TIMESTAMP, nullable=False)

    vulnerability = relationship("Vulnerability", back_populates="vulnerability_core_product")
    core_product = relationship("CoreProduct", back_populates="vulnerability_core_product")